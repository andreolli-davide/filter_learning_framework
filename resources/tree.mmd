graph TD

    %% Styles definition

    classDef input fill:#ffeba1,stroke:#d4a017,stroke-width:2px,color:#000
    classDef denoise fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px,color:#000
    classDef color fill:#fff9c4,stroke:#fbc02d,stroke-width:2px,color:#000
    classDef contrast fill:#e8f5e9,stroke:#43a047,stroke-width:2px,color:#000
    classDef sharpen fill:#f3e5f5,stroke:#8e24aa,stroke-width:2px,color:#000
    classDef output fill:#ffcdd2,stroke:#c62828,stroke-width:2px,color:#000

    %% Nodes
    
    Start((Input Image LCM)):::input

    subgraph Layer1 [Step 1: Noise Reduction]
        direction LR
        D0("No Denoise"):::denoise
        D1("Median Blur<br/>(Kernel=3)"):::denoise
        D2("Bilateral Filter<br/>(d=5, σColor=50, σSpace=50)"):::denoise
    end

    subgraph Layer2 [Step 2: Color Correction]
        direction LR
        Col0("Original Color"):::color
        Col1("Sat Boost<br/>(+30% / 1.3x)"):::color
    end

    subgraph Layer3 [Step 3: Contrast Enhancement]
        direction LR
        C0("No Contrast"):::contrast
        C2("CLAHE<br/>(Clip=4.0, Tile=8x8)"):::contrast
        C3("Gamma Correction<br/>(γ=1.2)"):::contrast
    end

    subgraph Layer4 [Step 4: Edge Sharpening]
        direction LR
        S0("No Sharpen"):::sharpen
        S1("Unsharp Mask<br/>(σ=1.0, Strength=1.5)"):::sharpen
        S2("Laplacian Sharpener<br/>(Standard 3x3)"):::sharpen
    end

    Final((YOLO Inference)):::output

    %% Full mesh connections
    
    Start --> D0 & D1 & D2
    D0 & D1 & D2 --> Col0 & Col1
    Col0 & Col1 --> C0 & C1 & C2 & C3
    C0 & C1 & C2 & C3 --> S0 & S1 & S2
    S0 & S1 & S2 --> Final
